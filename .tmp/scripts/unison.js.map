{"version":3,"sources":["unison.js"],"names":["Unison","win","window","doc","document","head","eventCache","unisonReady","currentBP","util","parseMQ","el","str","getComputedStyle","getPropertyValue","replace","debounce","func","wait","immediate","timeout","context","args","arguments","clearTimeout","setTimeout","apply","isObject","e","isUndefined","events","on","event","callback","push","emit","data","eventQ","slice","i","length","call","breakpoints","all","BPs","allBP","querySelector","split","mq","trim","now","nowBP","name","width","update","bp","onresize","addEventListener","fetch"],"mappings":"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","file":"unison.js","sourcesContent":["Unison = (function() {\r\n\r\n    'use strict';\r\n  \r\n    var win = window;\r\n    var doc = document;\r\n    var head = doc.head;\r\n    var eventCache = {};\r\n    var unisonReady = false;\r\n    var currentBP;\r\n  \r\n    var util = {\r\n      parseMQ : function(el) {\r\n        var str = win.getComputedStyle(el, null).getPropertyValue('font-family');\r\n        return str.replace(/\"/g, '').replace(/'/g, '');\r\n      },\r\n      debounce : function(func, wait, immediate) {\r\n        var timeout;\r\n        return function() {\r\n          var context = this, args = arguments;\r\n          clearTimeout(timeout);\r\n          timeout = setTimeout(function() {\r\n            timeout = null;\r\n            if (!immediate) {\r\n              func.apply(context, args);\r\n            }\r\n          }, wait);\r\n          if (immediate && !timeout) {\r\n            func.apply(context, args);\r\n          }\r\n        };\r\n      },\r\n      isObject : function(e) { return typeof e === 'object'; },\r\n      isUndefined : function(e) { return typeof e === 'undefined'; }\r\n    };\r\n  \r\n    var events = {\r\n      on : function(event, callback) {\r\n        if ( !util.isObject(eventCache[event]) ) {\r\n          eventCache[event] = [];\r\n        }\r\n        eventCache[event].push(callback);\r\n      },\r\n      emit : function(event, data) {\r\n        if ( util.isObject(eventCache[event]) ) {\r\n          var eventQ = eventCache[event].slice();\r\n          for ( var i = 0; i < eventQ.length; i++ ) {\r\n            eventQ[i].call(this, data);\r\n          }\r\n        }\r\n      }\r\n    };\r\n  \r\n    var breakpoints = {\r\n      all : function() {\r\n        var BPs = {};\r\n        var allBP = util.parseMQ(doc.querySelector('title')).split(',');\r\n        for ( var i = 0; i < allBP.length; i++ ) {\r\n          var mq = allBP[i].trim().split(' ');\r\n          BPs[mq[0]] = mq[1];\r\n        }\r\n        return ( unisonReady ) ? BPs : null ;\r\n      },\r\n      now : function(callback) {\r\n        var nowBP = util.parseMQ(head).split(' ');\r\n        var now = {\r\n          name : nowBP[0],\r\n          width : nowBP[1]\r\n        };\r\n        return ( unisonReady ) ? (( util.isUndefined(callback) ) ? now : callback(now)) : null ;\r\n      },\r\n      update : function() {\r\n        breakpoints.now(function(bp) {\r\n          if ( bp.name !== currentBP ) {\r\n            events.emit(bp.name);\r\n            events.emit('change', bp);\r\n            currentBP = bp.name;\r\n          }\r\n        });\r\n      }\r\n    };\r\n  \r\n    win.onresize = util.debounce(breakpoints.update, 100);\r\n    doc.addEventListener('DOMContentLoaded', function(){\r\n      unisonReady = win.getComputedStyle(head, null).getPropertyValue('clear') !== 'none';\r\n      breakpoints.update();\r\n    });\r\n  \r\n    return {\r\n      fetch : {\r\n        all : breakpoints.all,\r\n        now : breakpoints.now\r\n      },\r\n      on : events.on,\r\n      emit : events.emit,\r\n      util : {\r\n        debounce : util.debounce,\r\n        isObject : util.isObject\r\n      }\r\n    };\r\n  \r\n  })();"]}