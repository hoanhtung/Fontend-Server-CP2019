{"version":3,"sources":["vinhJS.js"],"names":["createTreatmentReport","shiftId","progressiveDisease","checkDrug","drugs","createDrugObj","$","ajax","url","EBSMSLocal","contentType","dataType","data","JSON","stringify","treatmentReportDrugs","method","done","rs","modal","loadTreatmentReport","fail","console","log","er","counts","find","each","name","querySelector","value","id","attr","undefined","alert","idTreatmentDrug","isMorning","isAfternoon","isEvening","isNight","push","length","div_treatment_table","empty","success","table","container","i","replace","medicalRequirement","forEach","element","morningQuantity","afternoonQuantity","eveningQuantity","nightQuantity","dateCreated","split","append","error","document","on","treatmentId","editForm","unit","text","val","loadHealthcareReport","div_healthcare_table","eventContent","careContent","badgeWoundCondition","woundCondition","DrugExcelExport","event","input","target","reader","FileReader","onload","fileData","result","wb","XLSX","read","type","SheetNames","sheetName","rowObj","utils","sheet_to_row_object_array","Sheets","sessionStorage","setItem","readAsBinaryString","files","saveDrug","drug","parse","getItem","drugInfo","sh","supplyList","supplyJson","s","medicalSupplyId","Number","surgeryShiftCode","removeItem","window","location","href","last","after","updateUnit","parent","siblings","getNurse","select","options","fullName"],"mappings":"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","file":"vinhJS.js","sourcesContent":["function createTreatmentReport(shiftId, progressiveDisease) {\r\n    if (!checkDrug()) {\r\n    } else {\r\n        var drugs = createDrugObj();\r\n        $.ajax({\r\n            url: EBSMSLocal + '/api/PostOp/CreateTreatmenReport',\r\n            contentType: 'application/json',\r\n            dataType: 'json',\r\n            data: JSON.stringify({\r\n                shiftId: shiftId,\r\n                progressiveDisease: progressiveDisease,\r\n                treatmentReportDrugs: drugs,\r\n            }),\r\n            method: 'post'\r\n        })\r\n            .done(rs => {\r\n                if (rs === true) {\r\n                    $('#treatmentModal').modal('toggle');\r\n                    loadTreatmentReport(shiftId);\r\n                }\r\n            })\r\n            .fail(er => console.log(er));\r\n    }\r\n\r\n}\r\n\r\nfunction checkDrug() {\r\n    var counts = [];\r\n    var rs = true;\r\n    $(\"body\").find(\".row-drug\").each(function () {\r\n        var name = this.querySelector('input[name=\"drug-name\"]').value;\r\n        var id = $(\"#drugs\").find('option[value=\"' + name + '\"]').attr('id');\r\n        if (id === undefined) {\r\n            rs = false;\r\n            alert(\"Please choose drug in list\");\r\n            return rs;\r\n        }\r\n        console.log(counts[id]);\r\n        if (counts[id] === undefined) {\r\n            counts[id] = 1;\r\n        } else {\r\n            rs = false;\r\n            alert(\"Duplicate drugs in your selection\");\r\n            return rs;\r\n        }\r\n    });\r\n    return rs;\r\n}\r\n\r\nfunction createDrugObj() {\r\n    var drugs = [];\r\n    $(\"body\").find(\".row-drug\").each(function () {\r\n        var idTreatmentDrug = this.querySelector('input[name=\"drug-id\"]').value != '' ? this.querySelector('input[name=\"drug-id\"]').value : 0;\r\n        var name = this.querySelector('input[name=\"drug-name\"]').value;\r\n        var id = $(\"#drugs\").find('option[value=\"' + name + '\"]').attr('id');\r\n        var isMorning = this.querySelector('input[name=\"isMorning\"]').value != '' ? this.querySelector('input[name=\"isMorning\"]').value : 0;\r\n        var isAfternoon = this.querySelector('input[name=\"isAfternoon\"]').value != '' ? this.querySelector('input[name=\"isAfternoon\"]').value : 0;\r\n        var isEvening = this.querySelector('input[name=\"isEvening\"]').value != '' ? this.querySelector('input[name=\"isEvening\"]').value : 0;\r\n        var isNight = this.querySelector('input[name=\"isNight\"]').value != '' ? this.querySelector('input[name=\"isNight\"]').value : 0;\r\n        if (isMorning == 0 && isAfternoon == 0 && isEvening == 0 && isNight == 0 && name != '') {\r\n            alert('Please input quantity for drug');\r\n        } else {\r\n            drugs.push({\r\n                'id' : idTreatmentDrug,\r\n                'drugId': id,\r\n                'morningQuantity': isMorning,\r\n                'afternoonQuantity': isAfternoon,\r\n                'eveningQuantity': isEvening,\r\n                'nightQuantity': isNight\r\n            })\r\n        }\r\n    });\r\n    console.log(drugs);\r\n    if (drugs.length > 0) {\r\n        return drugs;\r\n    }\r\n}\r\n\r\nfunction loadTreatmentReport(shiftId) {\r\n    var div_treatment_table = $('#div-treatment-table');\r\n    div_treatment_table.empty();\r\n    $.ajax({\r\n        url: EBSMSLocal + '/api/PostOp/GetTreatmentReportByShiftId?surgeryShiftId=' + shiftId,\r\n        method: 'get',\r\n        success: function (data) {\r\n            console.table(data);\r\n            if (data.length != 0) {\r\n                var container = '<table class=\"table \"><thead><tr><th>No.</th><th>Create Time</th>'\r\n                    + '<th>Progressive Disease</th><th>Medical Requirement</th><th>Action</th></tr></thead>';\r\n                for (var i = 0; i < data.length; i++) {\r\n                    var progressiveDisease = data[i].progressiveDisease.replace(/\\n/g, \"<br />\");\r\n                    var medicalRequirement = '';\r\n                    data[i].treatmentReportDrugs.forEach(element => {\r\n                        medicalRequirement += `${element.name} (Morning: ${element.morningQuantity}| Afternoon:${element.afternoonQuantity}| Evening:${element.eveningQuantity}| Night:${element.nightQuantity})</br>`;\r\n                    });\r\n                    // var medicalRequirement = data[i].medicalRequirement.replace(/\\n/g, \"<br />\");\r\n                    container += '<tr><td>' + (i + 1) + '</td>'\r\n                    container += '<td>' + data[i].dateCreated.split('T')[0] + '</td>'\r\n                        + '<td>' + progressiveDisease + '</td>'\r\n                        + '<td>' + medicalRequirement + '</td>'\r\n                        + `<td><button class='btn btn-info edit-treatment' data-id='${data[i].id}' data-toggle=\"modal\"\r\n                        data-target=\"#treatmentModal\">Edit</button> <button class='btn btn-danger'>Delete</button></td>` + '</tr>';\r\n                }\r\n\r\n                container += '</table>';\r\n                div_treatment_table.append(container);\r\n            } else {\r\n                div_treatment_table.append('<h2>Not found no treatment</h2>');\r\n            }\r\n\r\n        },\r\n        error: function (data) {\r\n            console.log(data);\r\n        }\r\n    })\r\n}\r\n\r\n$(document).on(\"click\", \".edit-treatment\", function () {\r\n    var treatmentId = $(this).data('id');\r\n    var editForm = $(\"#edit-form-treatement-report\");\r\n    editForm.empty();\r\n    $.ajax({\r\n        url: EBSMSLocal + '/api/PostOp/GetTreatmentReportById?id=' + treatmentId,\r\n        method: 'get',\r\n        success: function (data) {\r\n            console.table(data);\r\n                editForm.append(`<div class=\"form-group\">\r\n                                <label for=\"progressiveDisease\">Progressive Disease</label>\r\n                                <textarea class=\"form-control\" rows=\"5\"\r\n                                id=\"progressiveDisease\">${data.progressiveDisease}</textarea>\r\n                                </div>`);\r\n                editForm.append(`<div class=\"form-group\">\r\n                <label for=\"medicalRequirement\">Medical Requirement</label>\r\n                <button class=\"btn btn-success add-more float-right\" type=\"button\"><i class=\"fa fa-plus\"></i>Add more</button>\r\n                <div class=\"mt-4 row\">\r\n                    <div class=\"col-5\"></div>\r\n                    <div class=\"col-1\" style=\"text-align: center;\"> Unit</div>\r\n                    <div class=\"col-1\" style=\"text-align: center;\"> Morning</div>\r\n                    <div class=\"col-1\" style=\"text-align: center;\"> Noon</div>\r\n                    <div class=\"col-1\" style=\"text-align: center;\"> Evening</div>\r\n                    <div class=\"col-1\" style=\"text-align: center;\"> Night</div>\r\n                </div>\r\n                <datalist id=\"drugs\"></datalist>`);\r\n                data.treatmentReportDrugs.forEach(element => {\r\n                    editForm.append(\r\n                    `<div class=\"row row-drug control-group after-add-more\" style=\"padding-inline-start: 15px; margin-top: 10px\">\r\n                    <input type=\"text\" class=\"d-none\" name=\"drug-id\" value=\"${element.id}\" />\r\n                                                                <div class=\"easyautocomplete-wraper col-5\">\r\n                                                                <input type=\"text\" list=\"drugs\" class=\"drug form-control has-error\" name=\"drug-name\" placeholder=\"Enter drug name\" value=\"${element.name}\"  onchange=\"updateUnit.call(this, this.value)\"/>\r\n                                                                </div>\r\n                                                                <input type=\"text\" class=\"drug-quantity col-1 form-control  drug-used-time\" value=${element.unit} readonly/>\r\n                                                                <input type=\"number\" min=\"0\" class=\"col-1 drug-used-time form-control\" name=\"isMorning\" value=${element.morningQuantity}>\r\n                        <input type=\"number\" min=\"0\" class=\"col-1 drug-used-time form-control\" name=\"isAfternoon\"  value=${element.afternoonQuantity}>\r\n                        <input type=\"number\" min=\"0\" class=\"col-1 drug-used-time form-control\" name=\"isEvening\"  value=${element.eveningQuantity}>\r\n                        <input type=\"number\" min=\"0\" class=\"col-1 drug-used-time form-control\" name=\"isNight\"  value=${element.nightQuantity}>\r\n                                                                <div class=\"input-group-btn  col-1\">\r\n                                                                    <button class=\"btn btn-danger remove\" type=\"button\"><i class=\"fa fa-times\"></i></button>\r\n                                                                </div>`);\r\n                });\r\n                editForm.append('<\\div>');\r\n                editForm.append(`<button id=\"editTreatment\" type=\"button\" data-id='${treatmentId}' \r\n                                                        class=\"btn btn-success float-right\" style=\"margin-top: 10px\">Edit</button>`);\r\n            },\r\n        error: function (data) {\r\n            console.log(data);\r\n        }\r\n    });\r\n});\r\n\r\n$(document).on(\"click\", \"#editTreatment\", function () {\r\n    var treatmentId = $(this).data('id');\r\n    var shiftId = $('#span-id').text();\r\n    if (!checkDrug()) {\r\n    } else {\r\n        var drugs = createDrugObj();\r\n        $.ajax({\r\n            url: EBSMSLocal + '/api/PostOp/EditTreatmentReport',\r\n            contentType: 'application/json',\r\n            dataType: 'json',\r\n            data: JSON.stringify({\r\n                id : treatmentId,\r\n                progressiveDisease: $(\"#progressiveDisease\").val(),\r\n                treatmentReportDrugs: drugs,\r\n            }),\r\n            method: 'post'\r\n        })\r\n            .done(rs => {\r\n                if (rs === true) {\r\n                    $('#treatmentModal').modal('toggle');\r\n                    loadTreatmentReport(shiftId);\r\n                }\r\n            })\r\n            .fail(er => console.log(er));\r\n    }\r\n\r\n})\r\n\r\nfunction loadHealthcareReport(shiftId) {\r\n    var div_healthcare_table = $('#div-healthcare-table');\r\n    div_healthcare_table.empty();\r\n    $.ajax({\r\n        url: EBSMSLocal + '/api/PostOp/GetHealthCareReportBySurgeryShiftId?surgeryShiftId=' + shiftId,\r\n        method: 'get',\r\n        success: function (data) {\r\n            console.table(data);\r\n            if (data.length != 0) {\r\n                var container = '<table class=\"table \"><thead><tr><th>No.</th><th>Create Time</th>'\r\n                    + '<th>Wound Condition</th>'\r\n                    + '<th>Event Content</th><th>Care Content</th></tr></thead>';\r\n                for (var i = 0; i < data.length; i++) {\r\n                    var progressiveDisease = data[i].eventContent.replace(/\\n/g, \"<br />\");\r\n                    var medicalRequirement = data[i].careContent.replace(/\\n/g, \"<br />\");\r\n                    var badgeWoundCondition;\r\n                    switch (data[i].woundCondition) {\r\n                        case 1:\r\n                            badgeWoundCondition = '<span class=\"badge badge-success\">Good</span>';\r\n                            break;\r\n                        case 2:\r\n                            badgeWoundCondition = '<span class=\"badge badge-danger\">Bad</span>';\r\n                            break;\r\n                    }\r\n                    container += '<tr><td>' + (i + 1) + '</td>'\r\n                    container += '<td>' + data[i].dateCreated.split('T')[0] + '</td>'\r\n                        + `<td>${badgeWoundCondition}</td>`\r\n                        + '<td>' + progressiveDisease + '</td>'\r\n                        + '<td>' + medicalRequirement + '</td></tr>';\r\n                }\r\n                container += '</table>';\r\n                div_healthcare_table.append(container);\r\n            } else {\r\n                div_healthcare_table.append('<h2>Not found no healthcare report</h2>');\r\n            }\r\n\r\n        },\r\n        error: function (data) {\r\n            console.log(data);\r\n        }\r\n    })\r\n}\r\n\r\nfunction DrugExcelExport(event) {\r\n    var input = event.target;\r\n    var reader = new FileReader();\r\n    reader.onload = function () {\r\n        var fileData = reader.result;\r\n        var wb = XLSX.read(fileData, { type: 'binary' });\r\n\r\n        wb.SheetNames.forEach(function (sheetName) {\r\n            var rowObj = XLSX.utils.sheet_to_row_object_array(wb.Sheets[sheetName]);\r\n\r\n            switch (sheetName) {\r\n                case 'Sheet2':\r\n                    // parseImportInfo(rowObj);\r\n                    sessionStorage.setItem('drugObj', JSON.stringify(rowObj));\r\n                    break;\r\n            }\r\n        })\r\n    };\r\n    reader.readAsBinaryString(input.files[0]);\r\n};\r\n\r\nfunction saveDrug() {\r\n    var drug = JSON.parse(sessionStorage.getItem('drugObj'));\r\n    var drugInfo = [];\r\n    for (var sh in drug) {\r\n        drugInfo.push({\r\n            'name': drug[sh]['Name'],\r\n            'unit': (drug[sh]['Unit'])\r\n        })\r\n    }\r\n    $.ajax({\r\n        url: EBSMSLocal + '/api/Drug/ImportDrug',\r\n        method: 'post',\r\n        data: JSON.stringify(drugInfo),\r\n        contentType: 'application/json',\r\n        dataType: 'json',\r\n        success: function () {\r\n            var supplyList = JSON.parse(sessionStorage.getItem('supplyObj'));\r\n            var supplyJson = [];\r\n            for (var s in supplyList) {\r\n                supplyJson.push({\r\n                    medicalSupplyId: Number(supplyList[s]['Code']),\r\n                    surgeryShiftCode: supplyList[s]['Surgery Shift Code']\r\n                });\r\n            }\r\n            $.ajax({\r\n                url: EBSMSLocal + '/api/Import/ImportSurgeryShiftMedicalSupply',\r\n                method: 'post',\r\n                data: JSON.stringify(supplyJson),\r\n                contentType: 'application/json',\r\n                dataType: 'json',\r\n                success: function () {\r\n                    sessionStorage.removeItem('infoObj');\r\n                    sessionStorage.removeItem('supplyObj');\r\n                    alert('Import successfully!')\r\n                    window.location.href = 'confirmMSRequest.html';\r\n                }\r\n            })\r\n\r\n        }\r\n    })\r\n}\r\n\r\n$(document).on(\"click\", \"#btn-new-treatment\", function () {\r\n    $(\"#treatmentModal\").empty();\r\n    $(\"#treatmentModal\").append(` <div class=\"modal-dialog modal-lg\" style=\"max-width: max-content;\" role=\"document\">\r\n            <div class=\"modal-content\">\r\n                <div class=\"modal-header\">\r\n                    <h5 class=\"modal-title\">Treatment</h5>\r\n                    <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\r\n                        <span aria-hidden=\"true\">&times;</span>\r\n                    </button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <div class=\"container-fluid\">\r\n                        <div class=\"row\">\r\n                            <div class=\"col px-0\">\r\n                                 <ul class=\"nav nav-tabs\" id=\"myTab\" role=\"tablist\">\r\n                                    <!-- <li class=\"nav-item\">\r\n                                        <a class=\"nav-link active\" id=\"treatment-tab\" data-toggle=\"tab\"\r\n                                            href=\"#treatment\" role=\"tab\" aria-controls=\"treatment\"\r\n                                            aria-selected=\"true\">New Treatment Report</a>\r\n                                    </li>  -->\r\n                                </ul>\r\n                                <div class=\"tab-content\" id=\"myTabContent\">\r\n                                    <div class=\"tab-pane fade show active\" id=\"treatment\" role=\"tabpanel\"\r\n                                        aria-labelledby=\"treatment-tab\">\r\n                                        <div class=\"container-fluid\">\r\n                                            <div class=\"row\">\r\n                                                <div id=\"edit-form-treatement-report\" class=\"col py-3\"\r\n                                                    style=\"border-left: 1px solid #dee2e6;border-bottom: 1px solid #dee2e6;border-right: 1px solid #dee2e6;\">\r\n                                                    <div class=\"form-group\">\r\n                                                        <label for=\"progressiveDisease\">Progressive Disease</label>\r\n                                                        <textarea class=\"form-control\" rows=\"5\"\r\n                                                            id=\"progressiveDisease\"></textarea>\r\n                                                    </div>\r\n                                                    <div class=\"form-group\">\r\n                                                        <label for=\"medicalRequirement\">Medical Requirement</label>\r\n                                                        <button class=\"btn btn-success add-more float-right\" type=\"button\"><i class=\"fa fa-plus\"></i>Add more</button>\r\n                                                        <div class=\"mt-4 row\">\r\n                                                            <div class=\"col-5\"></div>\r\n                                                            <div class=\"col-1\" style=\"text-align: center;\"> Unit</div>\r\n                                                            <div class=\"col-1\" style=\"text-align: center;\"> Morning</div>\r\n                                                            <div class=\"col-1\" style=\"text-align: center;\"> Noon</div>\r\n                                                            <div class=\"col-1\" style=\"text-align: center;\"> Evening</div>\r\n                                                            <div class=\"col-1\" style=\"text-align: center;\"> Night</div>\r\n                                                        </div>\r\n                                                        <datalist id=\"drugs\"></datalist>\r\n                                                        <div class=\"row row-drug after-add-more\" style=\"padding-inline-start: 15px;\">\r\n                                                            <input type=\"number\" class=\"d-none\" name=\"drug-id\" value=\"\" />\r\n                                                            <div class=\"easyautocomplete-wraper form-group col-5\" style=\"margin-bottom: 0px\">\r\n                                                                <input type=\"text\" list=\"drugs\" class=\"drug form-control has-error\" name=\"drug-name\" placeholder=\"Enter drug name\" onchange=\"updateUnit.call(this, this.value)\"/>\r\n                                                            </div>\r\n                                                            <input type=\"text\" class=\"drug-quantity col-1 form-control  drug-used-time\" readonly/>\r\n                                                            <input type=\"number\" min=\"0\" class=\"col-1 drug-used-time form-control\" name=\"isMorning\">\r\n                                                            <input type=\"number\" min=\"0\" class=\"col-1 drug-used-time form-control\" name=\"isAfternoon\">\r\n                                                            <input type=\"number\" min=\"0\" class=\"col-1 drug-used-time form-control\" name=\"isEvening\">\r\n                                                            <input type=\"number\" min=\"0\" class=\"col-1 drug-used-time form-control\" name=\"isNight\">\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <button id=\"createTreatment\" type=\"button\"\r\n                                                        class=\"btn btn-success float-right\">Create</button>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <!-- <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">Close</button>  -->\r\n                </div>\r\n            </div>\r\n        </div>`);\r\n})\r\n\r\n$(document).on(\"click\", \".add-more\", function () {\r\n                $(\".after-add-more\").last().after(`<div class=\"row row-drug control-group after-add-more\" style=\"padding-inline-start: 15px; margin-top: 10px\">\r\n                <input type=\"number\" class=\"d-none\" name=\"drug-id\" value=\"\" />\r\n                                                                    <div class=\"easyautocomplete-wraper col-5\">\r\n                                                                    <input type=\"text\" list=\"drugs\" class=\"drug form-control \" name=\"drug-name\"  placeholder=\"Enter drug name\"  onchange=\"updateUnit.call(this, this.value)\"/>\r\n                                                                </div>\r\n                                                                <input type=\"text\" class=\"drug-quantity col-1 form-control  drug-used-time\" readonly/>\r\n                                                                <input type=\"number\" min=\"0\" class=\"col-1 drug-used-time form-control\" name=\"isMorning\">\r\n                                                                <input type=\"number\" min=\"0\" class=\"col-1 drug-used-time form-control\" name=\"isAfternoon\">\r\n                                                                <input type=\"number\" min=\"0\" class=\"col-1 drug-used-time form-control\" name=\"isEvening\">\r\n                                                                <input type=\"number\" min=\"0\" class=\"col-1 drug-used-time form-control\" name=\"isNight\">\r\n                                                                <div class=\"input-group-btn  col-1\">\r\n                                                                    <button class=\"btn btn-danger remove\" type=\"button\"><i class=\"fa fa-times\"></i></button>\r\n                                                                </div>\r\n                                                            </div>`);\r\n    // autocompleteDrug();\r\n});\r\n\r\n$(document).on(\"click\", \"#createTreatment\", function () {\r\n    // var shiftId = $(this).data('shift-id');\r\n    var shiftId = $('#span-id').text();\r\n    var progressiveDisease = $('#progressiveDisease').val();\r\n    createTreatmentReport(shiftId, progressiveDisease);\r\n\r\n});\r\n\r\nfunction updateUnit(name){\r\n    var id = $(\"#drugs\").find('option[value=\"' + name + '\"]').data('unit');\r\n    console.log(id);\r\n    console.log($(this).parent().siblings('.drug-quantity'));\r\n    $(this).parent().siblings('.drug-quantity').val(id);\r\n}\r\n\r\nfunction getNurse(){\r\n    var select = $(\"#select-nurse\");\r\n    $.ajax({\r\n        url: EBSMSLocal + '/api/Account/GetAllNurse',\r\n        method: 'get',\r\n        success: function (data) {\r\n\r\n            $(data).each(function () {\r\n                var options = `<option id='${this.id}' value='${this.fullName}'>${this.fullName}</option>`;\r\n                select.append(options);\r\n            });\r\n        }\r\n    });\r\n}"]}