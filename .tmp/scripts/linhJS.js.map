<<<<<<< HEAD
{"version":3,"sources":["linhJS.js"],"names":["removeSessionStorage","sessionStorage","removeItem","javascript","window","location","href","getJSONfromSession","infoJSON","JSON","parse","getItem","supplyJSON","parseImportInfo","ExcelExport","event","input","target","reader","FileReader","onload","fileData","result","wb","XLSX","read","type","SheetNames","forEach","sheetName","rowObj","utils","sheet_to_row_object_array","Sheets","setItem","stringify","readAsBinaryString","files","jsonObj","table","document","getElementById","getElementsByTagName","newRow","insertRow","rows","length","newColumn","insertCell","appendChild","createTextNode","i","a","createElement","surgeryShiftCode","addEventListener","getImportDetail","saveSurgeryProfile","shift","shiftInfo","sh","gender","proStartDate","proEndDate","undefined","day","start","split","end","push","Number","$","ajax","url","EBSMSLocal","method","data","contentType","dataType","success","supplyList","supplyJson","s","medicalSupplyId","alert","id","parseImportDetail","URL","searchParams","get","j","confirmAllSupply","ids","checkboxS","getElementsByClassName","checked","value","getMedicalRequest","checkBox","setAttribute","button","getMedicalRequestDetail","surgeryShiftId","messesage","innerHTML","selectAllCheckboxes","chkSurgery"],"mappings":"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","file":"linhJS.js","sourcesContent":["function removeSessionStorage() {\n    sessionStorage.removeItem('infoObj');\n    sessionStorage.removeItem('supplyObj');\n    javascript: window.location.href = 'importList.html'\n}\n\nfunction getJSONfromSession() {\n    var infoJSON = JSON.parse(sessionStorage.getItem('infoObj'));\n    var supplyJSON = JSON.parse(sessionStorage.getItem('supplyObj'));\n    if (infoJSON != null)\n        parseImportInfo(infoJSON);\n}\n\nfunction ExcelExport(event) {\n    var input = event.target;\n    var reader = new FileReader();\n    reader.onload = function () {\n        var fileData = reader.result;\n        var wb = XLSX.read(fileData, { type: 'binary' });\n\n        wb.SheetNames.forEach(function (sheetName) {\n            var rowObj = XLSX.utils.sheet_to_row_object_array(wb.Sheets[sheetName]);\n\n            switch (sheetName) {\n                case 'SurgeryProfile':\n                    parseImportInfo(rowObj);\n                    sessionStorage.setItem('infoObj', JSON.stringify(rowObj));\n                    break;\n                case 'MedicalSupply':\n                    sessionStorage.setItem('supplyObj', JSON.stringify(rowObj));\n                    break;\n            }\n        })\n    };\n    reader.readAsBinaryString(input.files[0]);\n};\nfunction parseImportInfo(jsonObj) {\n    var table = document.getElementById('profile').getElementsByTagName('tbody')[0];\n    for (var i = 0; i < jsonObj.length; i++) {\n        var newRow = table.insertRow(table.rows.length);\n        var newColumn;\n        newColumn = newRow.insertCell(0);\n        newColumn.appendChild(document.createTextNode(i + 1));\n        newColumn = newRow.insertCell(1);\n        var a = document.createElement('a');\n        a.appendChild(document.createTextNode(jsonObj[i]['Patient Name']));\n        a.href = '#';\n        let surgeryShiftCode = jsonObj[i]['Surgery Shift Code'];\n        a.addEventListener(\"click\", () => {\n            getImportDetail(surgeryShiftCode);\n        });\n        newColumn.appendChild(a);\n        newColumn = newRow.insertCell(2);\n        newColumn.appendChild(document.createTextNode(jsonObj[i]['Gender']));\n        newColumn = newRow.insertCell(3);\n        newColumn.appendChild(document.createTextNode(jsonObj[i]['Gender']));\n        newColumn = newRow.insertCell(4);\n        if (jsonObj[i]['Expected Date'] == null && jsonObj[i]['Expected Time'] == null) {\n            newColumn.appendChild(document.createTextNode('N/A'));\n        }\n        else {\n            newColumn.appendChild(document.createTextNode(jsonObj[i]['Expected Date'] +\n                ' - ' + jsonObj[i]['Expected Time']));\n        }\n    }\n}\n\nfunction saveSurgeryProfile() {\n    var shift = JSON.parse(sessionStorage.getItem('infoObj'));\n    var shiftInfo = [];\n    for (var sh in shift) {\n        var gender = -1;\n        var proStartDate = '', proEndDate = '';\n        if (shift[sh]['Expected Date'] != undefined && shift[sh]['Expected Time'] != undefined) {\n            var day = shift[sh]['Expected Date'];\n            var start = shift[sh]['Expected Time'].split(' - ')[0];\n            var end = shift[sh]['Expected Time'].split(' - ')[1];\n            proStartDate = day + ' ' + start;\n            proEndDate = day + ' ' + end;\n        }\n        if (shift[sh]['Gender'] == 'M') gender = 1;\n        shiftInfo.push({\n            'expectedSurgeryDuration': shift[sh]['Surgery Weight'],\n            'priorityNumber': Number(shift[sh]['Priority']),\n            'patientID': shift[sh]['Patient Id'],\n            'patientName': shift[sh]['Patient Name'],\n            'gender': gender,\n            'yearOfBirth': Number(shift[sh]['Patient DOB']),\n            'surgeryCatalogID': Number(shift[sh]['Surgery Code']),\n            'surgeryShiftCode': shift[sh]['Surgery Shift Code'],\n            'surgeonId': Number(shift[sh]['SurgeonID']),\n            'proposedStartDateTime': proStartDate,\n            'proposedEndDateTime': proEndDate\n        })\n    }\n    $.ajax({\n        url: EBSMSLocal + '/api/Import/ImportSurgeryShift',\n        method: 'post',\n        data: JSON.stringify(shiftInfo),\n        contentType: 'application/json',\n        dataType: 'json',\n        success: function () {\n            var supplyList = JSON.parse(sessionStorage.getItem('supplyObj'));\n            var supplyJson = [];\n            for (var s in supplyList) {\n                supplyJson.push({\n                    medicalSupplyId: Number(supplyList[s]['Code']),\n                    surgeryShiftCode: supplyList[s]['Surgery Shift Code']\n                });\n            }\n            $.ajax({\n                url: EBSMSLocal + '/api/Import/ImportSurgeryShiftMedicalSupply',\n                method: 'post',\n                data: JSON.stringify(supplyJson),\n                contentType: 'application/json',\n                dataType: 'json',\n                success: function () {\n                    sessionStorage.removeItem('infoObj');\n                    sessionStorage.removeItem('supplyObj');\n                    alert('Import successfully!')\n                    window.location.href = 'confirmMSRequest.html';\n                }\n            })\n\n        }\n    })\n}\n\nfunction getImportDetail(id) {\n    window.location.href = 'importDetail.html?Id=' + id;\n}\nfunction parseImportDetail() {\n    var url = new URL(window.location.href);\n    var id = url.searchParams.get(\"Id\");\n    var supplyJSON = JSON.parse(sessionStorage.getItem('supplyObj'));\n    var table = document.getElementById('listSupply').getElementsByTagName('tbody')[0];\n    var j = 0;\n    for (var i = 0; i < supplyJSON.length; i++) {\n        if (supplyJSON[i]['Surgery Shift Code'] == id) {\n            var newRow = table.insertRow(table.rows.length);\n            var newColumn;\n            newColumn = newRow.insertCell(0);\n            newColumn.appendChild(document.createTextNode(++j));\n            newColumn = newRow.insertCell(1);\n            newColumn.appendChild(document.createTextNode(supplyJSON[i]['Name']));\n        }\n    }\n}\n\nfunction confirmAllSupply() {\n    var ids = [];\n    var checkboxS = document.getElementsByClassName('checkbox');\n    for (var i = 0; i < checkboxS.length; i++) {\n        if (checkboxS[i].checked) {\n            var value = Number(checkboxS[i].value);\n            var id = { id: value };\n            ids.push(id);\n        }\n    }\n    $.ajax({\n        url: EBSMSLocal + '/api/MedicalConfirm/ConfirmMedicalRequest',\n        method: 'post',\n        contentType: 'application/json',\n        dataType: 'json',\n        data: JSON.stringify(ids),\n        success: function () {\n            alert('success');\n            // window.location.href = 'viewShiftNoSchedule.html';\n        }\n    })\n\n}\n//Get all medical supply request\nfunction getMedicalRequest() {\n    $.ajax({\n        url: EBSMSLocal + '/api/MedicalConfirm/GetAllMedicalSupplyRequest',\n        method: 'get',\n        success: function (data) {\n            var table = document.getElementById('request').getElementsByTagName('tbody')[0];\n            for (var i = 0; i < data.length; i++) {\n                var id = data[i]['id'];\n                var newRow = table.insertRow(table.rows.length);\n                var newColumn;\n                newColumn = newRow.insertCell(0);\n                var checkBox = document.createElement(\"input\");\n                checkBox.setAttribute(\"type\", \"checkbox\");\n                checkBox.setAttribute(\"value\", id);\n                checkBox.setAttribute(\"class\", \"checkbox chkSurgery\");\n                newColumn.appendChild(checkBox);\n                newColumn = newRow.insertCell(1);\n                newColumn.appendChild(document.createTextNode(data[i]['patientName']));\n                newColumn = newRow.insertCell(2);\n                newColumn.appendChild(document.createTextNode(data[i]['surgeryName']));\n                newColumn = newRow.insertCell(3);\n                newColumn.appendChild(document.createTextNode(data[i]['createdDate']));\n                newColumn = newRow.insertCell(4);\n\n                var button = document.createElement('button');\n                button.appendChild(document.createTextNode(\"View Detail\"));\n                button.setAttribute(\"onclick\", \"getMedicalRequestDetail(\" + id + \");\");\n                button.setAttribute(\"id\", \"myBtn\");\n                button.setAttribute(\"type\", \"button\");\n                button.setAttribute(\"data-toggle\", \"modal\");\n                button.setAttribute(\"data-target\", \"#myModal\");\n                button.setAttribute(\"class\", \"btn btn-primary\");\n                newColumn.appendChild(button);\n\n            }\n        }\n    })\n}\n\nfunction getMedicalRequestDetail(id) {\n    $.ajax({\n        url: EBSMSLocal + '/api/MedicalConfirm/GetMedicalSupplyRequest',\n        method: 'get',\n        data: { surgeryShiftId: id },\n        success: function (data) {\n            var messesage = '';\n            if (data.length == 0) {\n                messesage = 'Not found medical supplies request';\n            } else {\n                for (var i = 0; i < data.length; i++) {\n                    messesage = messesage + '<p>' + (i + 1) + '. ' + data[i]['name'] + '</p>';\n                }\n            }           \n            document.getElementById('mheader').innerHTML = '<h4>Medical Supply Detail</h4><p>Surgery Shift Id - ' + id + '</p>';\n            document.getElementById('mbody').innerHTML = messesage;\n        }\n    })\n}\n\nfunction selectAllCheckboxes(event) {\n    var chkSurgery = $(\".chkSurgery\");\n    var checked = event.checked === true;\n    for (let i = 0; i < chkSurgery.length; i++) {\n        chkSurgery[i].checked = checked;\n    }\n\n}"]}
=======
{"version":3,"sources":["linhJS.js"],"names":["removeSessionStorage","sessionStorage","removeItem","javascript","window","location","href","getJSONfromSession","infoJSON","JSON","parse","getItem","supplyJSON","parseImportInfo","ExcelExport","event","input","target","reader","FileReader","onload","fileData","result","wb","XLSX","read","type","SheetNames","forEach","sheetName","rowObj","utils","sheet_to_row_object_array","Sheets","console","log","setItem","stringify","readAsBinaryString","files","jsonObj","table","document","getElementById","getElementsByTagName","newRow","insertRow","rows","length","newColumn","insertCell","appendChild","createTextNode","i","a","createElement","surgeryShiftCode","addEventListener","getImportDetail","saveSurgeryProfile","shift","shiftInfo","sh","gender","proStartDate","proEndDate","undefined","day","start","split","end","push","Number","$","ajax","url","EBSMSLocal","method","data","contentType","dataType","success","supplyList","supplyJson","s","medicalSupplyId","alert","id","messesage","confirmSupply","surgeryShiftId","surgeryCode","confirmAllSupply","ids","checkboxS","getElementsByClassName","checked","value","getMedicalRequest","checkBox","setAttribute","getMedicalRequestDetail","selectAllCheckboxes","chkSurgery"],"mappings":"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","file":"linhJS.js","sourcesContent":["\r\n// var EBSMSLocal = 'http://192.168.100.180:5000';\r\n// var EBSMSLocal = 'http://10.82.139.179:5000';\r\n// var EBSMSLocal = 'http://127.20.10.7:5000';\r\nfunction removeSessionStorage() {\r\n    sessionStorage.removeItem('infoObj');\r\n    sessionStorage.removeItem('supplyObj');\r\n    javascript:window.location.href='importList.html'\r\n}\r\n\r\nfunction getJSONfromSession() {\r\n    var infoJSON = JSON.parse(sessionStorage.getItem('infoObj'));\r\n    var supplyJSON = JSON.parse(sessionStorage.getItem('supplyObj'));\r\n    if (infoJSON != null)\r\n        parseImportInfo(infoJSON);\r\n}\r\n\r\nfunction ExcelExport(event) {\r\n    var input = event.target;\r\n    var reader = new FileReader();\r\n    reader.onload = function () {\r\n        var fileData = reader.result;\r\n        var wb = XLSX.read(fileData, { type: 'binary' });\r\n\r\n        wb.SheetNames.forEach(function (sheetName) {\r\n            var rowObj = XLSX.utils.sheet_to_row_object_array(wb.Sheets[sheetName]);\r\n\r\n            switch (sheetName) {\r\n                case 'SurgeryProfile':\r\n                console.log(rowObj);\r\n                    parseImportInfo(rowObj);\r\n                    sessionStorage.setItem('infoObj', JSON.stringify(rowObj));\r\n                    break;\r\n                case 'MedicalSupply':\r\n                    sessionStorage.setItem('supplyObj', JSON.stringify(rowObj));\r\n                    break;\r\n            }\r\n        })\r\n    };\r\n    reader.readAsBinaryString(input.files[0]);\r\n};\r\nfunction parseImportInfo(jsonObj) {\r\n    var table = document.getElementById('profile').getElementsByTagName('tbody')[0];\r\n    for (var i = 0; i < jsonObj.length; i++) {\r\n        var newRow = table.insertRow(table.rows.length);\r\n        var newColumn;\r\n\r\n        newColumn = newRow.insertCell(0);\r\n        // var checkBox = document.createElement(\"input\");\r\n        // checkBox.setAttribute(\"type\", \"checkbox\");\r\n        // checkBox.setAttribute(\"value\", jsonObj[i]['Surgery Shift Code']);\r\n        // checkBox.setAttribute(\"class\", \"checkbox\");\r\n        // newColumn.appendChild(checkBox);\r\n        newColumn = newRow.insertCell(1);\r\n        newColumn.appendChild(document.createTextNode(i + 1));\r\n        newColumn = newRow.insertCell(2);\r\n        var a = document.createElement('a');\r\n        a.appendChild(document.createTextNode(jsonObj[i]['Patient Name']));\r\n        a.href = '#';\r\n        let surgeryShiftCode = jsonObj[i]['Surgery Shift Code'];\r\n        a.addEventListener('click', () => {\r\n            getImportDetail(surgeryShiftCode);\r\n        });\r\n        newColumn.appendChild(a);\r\n        newColumn = newRow.insertCell(3);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i]['Gender']));\r\n        newColumn = newRow.insertCell(4);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i]['Surgery Name']));\r\n        newColumn = newRow.insertCell(5);\r\n        if (jsonObj[i]['Expected Date'] == null && jsonObj[i]['Expected Time'] == null) {\r\n            newColumn.appendChild(document.createTextNode('N/A'));\r\n        }\r\n        else {\r\n            newColumn.appendChild(document.createTextNode(jsonObj[i]['Expected Date'] +\r\n            ' - ' + jsonObj[i]['Expected Time']));\r\n        }\r\n    }\r\n}\r\n\r\nfunction saveSurgeryProfile() {\r\n    var shift = JSON.parse(sessionStorage.getItem('infoObj'));\r\n    var shiftInfo = [];\r\n    for (var sh in shift) {\r\n        var gender = -1;\r\n        var proStartDate = '', proEndDate = '';\r\n        if (shift[sh]['Expected Date'] != undefined && shift[sh]['Expected Time'] != undefined) {\r\n            var day = shift[sh]['Expected Date'];\r\n            console.log(shift[sh]['Expected Time']);\r\n            var start = shift[sh]['Expected Time'].split(' - ')[0];\r\n            console.log(start);\r\n            var end = shift[sh]['Expected Time'].split(' - ')[1];\r\n            console.log(end);\r\n            proStartDate = day + ' ' + start;\r\n            proEndDate = day + ' ' + end;\r\n        }\r\n        if (shift[sh]['Gender'] == 'Male') gender = 1;\r\n        shiftInfo.push({\r\n            'expectedSurgeryDuration': shift[sh]['Surgery Weight'],\r\n            'priorityNumber': Number(shift[sh]['Priority']),\r\n            'patientID': shift[sh]['Patient Id'],\r\n            'patientName': shift[sh]['Patient Name'],\r\n            'gender': gender,\r\n            'yearOfBirth': Number(shift[sh]['Patient DOB']),\r\n            'surgeryCatalogID': Number(shift[sh]['Surgery Code']),\r\n            'surgeryShiftCode': shift[sh]['Surgery Shift Code'],\r\n            'surgeonId': Number(shift[sh]['SurgeonID']),\r\n            'proposedStartDateTime': proStartDate,\r\n            'proposedEndDateTime': proEndDate\r\n        })\r\n    }\r\n\r\n    $.ajax({\r\n        url: EBSMSLocal + '/api/Import/ImportSurgeryShift',\r\n        method: 'post',\r\n        data: JSON.stringify(shiftInfo),\r\n        contentType: 'application/json',\r\n        dataType: 'json',\r\n        success: function () {\r\n            var supplyList = JSON.parse(sessionStorage.getItem('supplyObj'));\r\n            var supplyJson = [];\r\n            for (var s in supplyList) {\r\n                supplyJson.push({\r\n                    medicalSupplyId: Number(supplyList[s]['Code']),\r\n                    surgeryShiftCode: supplyList[s]['Surgery Shift Code']\r\n                });\r\n            }\r\n            console.log(supplyJson);\r\n            $.ajax({\r\n                url: EBSMSLocal + '/api/Import/ImportSurgeryShiftMedicalSupply',\r\n                method: 'post',\r\n                data: JSON.stringify(supplyJson),\r\n                contentType: 'application/json',\r\n                dataType: 'json',\r\n                success: function () {\r\n                    sessionStorage.removeItem('infoObj');\r\n                    sessionStorage.removeItem('supplyObj');\r\n                    alert('Import successfully!')\r\n                    window.location.href = 'confirmMSRequest.html';\r\n                }\r\n            })\r\n\r\n        }\r\n    })\r\n}\r\n\r\nfunction getImportDetail(id) {\r\n    var messesage = '';\r\n    var supplyJSON = JSON.parse(sessionStorage.getItem('supplyObj'));\r\n    for (var i = 0; i < supplyJSON.length; i++) {\r\n        if (supplyJSON[i]['Surgery Shift Code'] == id) {\r\n            messesage = messesage + 'No.' + (i + 1) + supplyJSON[i]['Code']\r\n                + ' ' + supplyJSON[i]['Name'] + '\\n';\r\n        }\r\n    }\r\n    console.log(messesage);\r\n    alert(messesage);\r\n}\r\n\r\n\r\n//Send confirm MS\r\nfunction confirmSupply() {\r\n    $.ajax({\r\n        url: EBSMSLocal + '/api/MedicalConfirm/ConfirmMedicalRequest',\r\n        method: 'get',\r\n        data: { surgeryShiftId: surgeryCode }\r\n    })\r\n    window.location.href = 'confirmMSRequest.html';\r\n}\r\n\r\n\r\nfunction confirmAllSupply() {\r\n    var ids = [];\r\n    var checkboxS = document.getElementsByClassName('checkbox');\r\n    for (var i = 0; i < checkboxS.length; i++) {\r\n        if (checkboxS[i].checked) {\r\n            var value = Number(checkboxS[i].value);\r\n            var id = {id: value};\r\n            ids.push(id);\r\n        }\r\n    }\r\n    $.ajax({\r\n        url: EBSMSLocal + '/api/MedicalConfirm/ConfirmMedicalRequest',\r\n        method: 'post',\r\n        contentType: 'application/json',\r\n        dataType: 'json',\r\n        data: JSON.stringify(ids),\r\n        success: function () {\r\n            alert('success');\r\n        }\r\n    })\r\n    window.location.href = 'viewShiftNoSchedule.html';\r\n}\r\n//Get all medical supply request\r\nfunction getMedicalRequest() {\r\n    $.ajax({\r\n        url: EBSMSLocal + '/api/MedicalConfirm/GetAllMedicalSupplyRequest',\r\n        method: 'get',\r\n        success: function (data) {\r\n            var table = document.getElementById('request').getElementsByTagName('tbody')[0];\r\n            for (var i = 0; i < data.length; i++) {\r\n                var id = data[i]['id'];\r\n                var newRow = table.insertRow(table.rows.length);\r\n                var newColumn;\r\n                newColumn = newRow.insertCell(0);\r\n                var checkBox = document.createElement('input');\r\n                checkBox.setAttribute('type', 'checkbox');\r\n                checkBox.setAttribute('value', id);\r\n                checkBox.setAttribute('class', 'checkbox chkSurgery');\r\n                newColumn.appendChild(checkBox);\r\n                newColumn = newRow.insertCell(1);\r\n                newColumn.appendChild(document.createTextNode(data[i]['patientName']));\r\n                newColumn = newRow.insertCell(2);\r\n                newColumn.appendChild(document.createTextNode(data[i]['surgeryName']));\r\n                newColumn = newRow.insertCell(3);\r\n                newColumn.appendChild(document.createTextNode(data[i]['createdDate']));\r\n                newColumn = newRow.insertCell(4);\r\n                var a = document.createElement('a');\r\n                a.href = '#';\r\n                a.appendChild(document.createTextNode('...'));\r\n                a.setAttribute('onclick', 'getMedicalRequestDetail(\" + id + \");');\r\n                newColumn.appendChild(a);\r\n\r\n            }\r\n        }\r\n    })\r\n}\r\n\r\nfunction getMedicalRequestDetail(id) {\r\n    //get surgery code from url\r\n    $.ajax({\r\n        url: EBSMSLocal + '/api/MedicalConfirm/GetMedicalSupplyRequest',\r\n        method: 'get',\r\n        data: { surgeryShiftId: id },\r\n        success: function (data) {\r\n            console.log(data);\r\n            var messesage = '';\r\n            for (var i = 0; i < data.length; i++) {\r\n                messesage = messesage + 'no. ' + (i + 1) + ' ' + data[i]['name'] + '.\\n';\r\n            }\r\n            alert(messesage);\r\n        }\r\n    })\r\n}\r\n\r\nfunction selectAllCheckboxes(event) {\r\n    var chkSurgery = $('.chkSurgery');\r\n    var checked = event.checked === true;\r\n    for (let i = 0; i < chkSurgery.length; i++) {\r\n        chkSurgery[i].checked = checked;\r\n    }\r\n}"]}
>>>>>>> c292e964e96d35931f448162f71044e6e5e5db5b
