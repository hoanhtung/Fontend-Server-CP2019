<<<<<<< HEAD
{"version":3,"sources":["linhJS.js"],"names":["EBSMSLocal","removeSessionStorage","sessionStorage","removeItem","javascript","window","location","href","getJSONfromSession","infoJSON","JSON","parse","getItem","supplyJSON","parseImportInfo","ExcelExport","event","input","target","reader","FileReader","onload","fileData","result","wb","XLSX","read","type","SheetNames","forEach","sheetName","rowObj","utils","sheet_to_row_object_array","Sheets","console","log","setItem","stringify","readAsBinaryString","files","jsonObj","table","document","getElementById","getElementsByTagName","i","length","newRow","insertRow","rows","newColumn","insertCell","a","createElement","appendChild","createTextNode","saveSurgeryProfile","shift","shiftInfo","sh","gender","proStartDate","proEndDate","undefined","day","start","split","end","push","Number","$","ajax","url","method","data","contentType","dataType","success","supplyList","supplyJson","s","medicalSupplyId","surgeryShiftCode","alert","deleteRecord","url_string","URL","no","searchParams","get","parseJSONImportDetail","j","getImportDetail","surgeryCode","getRequestDetail","innerHTML","surgeryShiftId","confirmSupply","confirmAllSupply","getMedicalRequest"],"mappings":"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","file":"linhJS.js","sourcesContent":["var EBSMSLocal = 'http://192.168.100.180:5000';\r\nfunction removeSessionStorage() {\r\n    sessionStorage.removeItem('infoObj');\r\n    sessionStorage.removeItem('supplyObj');\r\n    javascript:window.location.href='importList.html'\r\n}\r\n\r\nfunction getJSONfromSession() {\r\n    var infoJSON = JSON.parse(sessionStorage.getItem('infoObj'));\r\n    var supplyJSON = JSON.parse(sessionStorage.getItem('supplyObj'));\r\n    if (infoJSON != null)\r\n        parseImportInfo(infoJSON);\r\n}\r\n\r\nfunction ExcelExport(event) {\r\n    var input = event.target;\r\n    var reader = new FileReader();\r\n    reader.onload = function () {\r\n        var fileData = reader.result;\r\n        var wb = XLSX.read(fileData, { type: 'binary' });\r\n\r\n        wb.SheetNames.forEach(function (sheetName) {\r\n            var rowObj = XLSX.utils.sheet_to_row_object_array(wb.Sheets[sheetName]);\r\n\r\n            switch (sheetName) {\r\n                case 'SurgeryProfile':\r\n                console.log(rowObj);\r\n                    parseImportInfo(rowObj);\r\n                    sessionStorage.setItem('infoObj', JSON.stringify(rowObj));\r\n                    break;\r\n                case 'MedicalSupply':\r\n                    sessionStorage.setItem('supplyObj', JSON.stringify(rowObj));\r\n                    break;\r\n            }\r\n        })\r\n    };\r\n    reader.readAsBinaryString(input.files[0]);\r\n};\r\nfunction parseImportInfo(jsonObj) {\r\n    var table = document.getElementById('profile').getElementsByTagName('tbody')[0];\r\n    for (var i = 0; i < jsonObj.length; i++) {\r\n        var newRow = table.insertRow(table.rows.length);\r\n        var newColumn;\r\n\r\n        newColumn = newRow.insertCell(0);\r\n        var a = document.createElement('a');\r\n        a.appendChild(document.createTextNode(jsonObj[i]['Patient Name']));\r\n        a.href = 'importDetail.html?no=' + jsonObj[i]['Surgery Shift Code'];\r\n        newColumn.appendChild(a);\r\n\r\n        newColumn = newRow.insertCell(1);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i]['Gender']));\r\n        newColumn = newRow.insertCell(2);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i]['Medical Record']));\r\n        newColumn = newRow.insertCell(3);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i]['Surgery Name']));\r\n        newColumn = newRow.insertCell(4);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i]['Surgeon Name']));\r\n        newColumn = newRow.insertCell(5);\r\n        if (jsonObj[i]['Expected Date'] == null && jsonObj[i]['Expected Time'] == null) {\r\n            newColumn.appendChild(document.createTextNode('N/A'));\r\n        }\r\n        else {\r\n            newColumn.appendChild(document.createTextNode(jsonObj[i]['Expected Date'] +\r\n            ' - ' + jsonObj[i]['Expected Time']));\r\n        }\r\n        newColumn = newRow.insertCell(6);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i]['Surgery Weight']));\r\n    }\r\n}\r\n\r\nfunction saveSurgeryProfile() {\r\n    var shift = JSON.parse(sessionStorage.getItem('infoObj'));\r\n    var shiftInfo = [];\r\n    for (var sh in shift) {\r\n        var gender = -1;\r\n        var proStartDate = '', proEndDate = '';\r\n        if (shift[sh]['Expected Date'] != undefined && shift[sh]['Expected Time'] != undefined) {\r\n            var day = shift[sh]['Expected Date'];\r\n            console.log(shift[sh]['Expected Time']);\r\n            var start = shift[sh]['Expected Time'].split(' - ')[0];\r\n            console.log(start);\r\n            var end = shift[sh]['Expected Time'].split(' - ')[1];\r\n            console.log(end);\r\n            proStartDate = day + ' ' + start;\r\n            proEndDate = day + ' ' + end;\r\n        }\r\n        if (shift[sh]['Gender'] == 'Male') gender = 1;\r\n        shiftInfo.push({\r\n            'expectedSurgeryDuration': shift[sh]['Surgery Weight'],\r\n            'priorityNumber': Number(shift[sh]['Priority']),\r\n            'patientID': shift[sh]['Patient Id'],\r\n            'patientName': shift[sh]['Patient Name'],\r\n            'gender': gender,\r\n            'yearOfBirth': Number(shift[sh]['Patient DOB']),\r\n            'surgeryCatalogID': Number(shift[sh]['Surgery Code']),\r\n            'surgeryShiftCode': shift[sh]['Surgery Shift Code'],\r\n            'surgeonId': Number(shift[sh]['SurgeonID']),\r\n            'proposedStartDateTime': proStartDate,\r\n            'proposedEndDateTime': proEndDate\r\n        })\r\n    }\r\n\r\n    $.ajax({\r\n        url: EBSMSLocal + '/api/Import/ImportSurgeryShift',\r\n        method: 'post',\r\n        data: JSON.stringify(shiftInfo),\r\n        contentType: 'application/json',\r\n        dataType: 'json',\r\n        success: function () {\r\n            var supplyList = JSON.parse(sessionStorage.getItem('supplyObj'));\r\n            var supplyJson = [];\r\n            for (var s in supplyList) {\r\n                supplyJson.push({\r\n                    medicalSupplyId: Number(supplyList[s]['Code']),\r\n                    surgeryShiftCode: supplyList[s]['Surgery Shift Code']\r\n                });\r\n            }\r\n            console.log(supplyJson);\r\n            $.ajax({\r\n                url: EBSMSLocal + '/api/Import/ImportSurgeryShiftMedicalSupply',\r\n                method: 'post',\r\n                data: JSON.stringify(supplyJson),\r\n                contentType: 'application/json',\r\n                dataType: 'json',\r\n                success: function() {\r\n                    sessionStorage.removeItem('infoObj');\r\n                    sessionStorage.removeItem('supplyObj');\r\n                    alert('Import successfully!')\r\n                    window.location.href = 'confirmMSRequest.html';\r\n                }\r\n            })\r\n            \r\n        }\r\n    })\r\n\r\n}\r\n\r\nfunction deleteRecord() {\r\n    var supplyJSON = JSON.parse(sessionStorage.getItem('supplyObj'));\r\n    var infoJSON = JSON.parse(sessionStorage.getItem('infoObj'));\r\n    var url_string = window.location.href;\r\n    var url = new URL(url_string);\r\n    var no = url.searchParams.get('no');\r\n\r\n    for (var i = 0; i < infoJSON.length; i++) {\r\n        if (infoJSON[i]['Surgery Shift Code'] == no) {\r\n            delete infoJSON[i];\r\n            break;\r\n        }\r\n    }\r\n    for (var i = 0; i < supplyJSON.length; i++) {\r\n        if (supplyJSON[i]['Surgery Shift Code'] == no) {\r\n            delete supplyJSON[i];\r\n            i--;\r\n        }\r\n    }\r\n    sessionStorage.removeItem('infoJSON');\r\n    sessionStorage.removeItem('supplyJSON');\r\n    sessionStorage.setItem('infoObj', JSON.stringify(infoJSON));\r\n    sessionStorage.setItem('supplyJSON', JSON.stringify(supplyJSON));\r\n    javascript: window.location.href = 'importList.html';\r\n}\r\n\r\nfunction parseJSONImportDetail(jsonObj) {\r\n    var table = document.getElementById('listSupply').getElementsByTagName('tbody')[0];\r\n    var supplyJSON = jsonObj;\r\n    var j = 0;\r\n    var url_string = window.location.href;\r\n    var url = new URL(url_string);\r\n    var no = url.searchParams.get('no');\r\n    for (var i = 0; i < supplyJSON.length; i++) {\r\n        if (supplyJSON[i]['Surgery Shift Code'] == no) {\r\n            var newRow = table.insertRow(table.rows.length);\r\n            var newColumn;\r\n\r\n            newColumn = newRow.insertCell(0);\r\n            newColumn.appendChild(document.createTextNode(++j));\r\n            newColumn = newRow.insertCell(1);\r\n            newColumn.appendChild(document.createTextNode(supplyJSON[i]['Code']));\r\n            newColumn = newRow.insertCell(2);\r\n            newColumn.appendChild(document.createTextNode(supplyJSON[i]['Name']));\r\n        }\r\n    }\r\n}\r\n\r\nfunction getImportDetail() {\r\n    //get surgery code from url\r\n    var url_string = window.location.href;\r\n    var url = new URL(url_string);\r\n    var no = url.searchParams.get('no');\r\n\r\n    var supplyJSON = JSON.parse(sessionStorage.getItem('supplyObj'));\r\n    parseJSONImportDetail(supplyJSON);\r\n}\r\n\r\n// === JS for MEDICAL SUPPLY CONFIRM ===\r\nvar surgeryCode;\r\n\r\nfunction getRequestDetail() {\r\n    //get surgery code from url\r\n    var url_string = window.location.href;\r\n    var url = new URL(url_string);\r\n    surgeryCode = url.searchParams.get('code');\r\n    document.getElementById('sid').innerHTML = surgeryCode;\r\n    document.getElementById('name').innerHTML = url.searchParams.get('sname');\r\n    document.getElementById('patient').innerHTML = url.searchParams.get('pname');\r\n    $.ajax({\r\n        url: EBSMSLocal + '/api/MedicalConfirm/GetMedicalSupplyRequest',\r\n        method: 'get',\r\n        data: { surgeryShiftId: surgeryCode },\r\n        success: function (data) {\r\n            var table = document.getElementById('listSupply').getElementsByTagName('tbody')[0];\r\n            for (var i = 0; i < data.length; i++) {\r\n                var newRow = table.insertRow(table.rows.length);\r\n                var newColumn;\r\n\r\n                newColumn = newRow.insertCell(0);\r\n                newColumn.appendChild(document.createTextNode(i + 1));\r\n                newColumn = newRow.insertCell(1);\r\n                newColumn.appendChild(document.createTextNode(data[i]['code']));\r\n                newColumn = newRow.insertCell(2);\r\n                newColumn.appendChild(document.createTextNode(data[i]['name']));\r\n            }\r\n        }\r\n    })\r\n}\r\n//Send confirm MS\r\nfunction confirmSupply() {\r\n    $.ajax({\r\n        url: EBSMSLocal + '/api/MedicalConfirm/ConfirmMedicalRequest',\r\n        method: 'get',\r\n        data: { surgeryShiftId: surgeryCode }\r\n    })\r\n    window.location.href = 'confirmMSRequest.html';\r\n}\r\n\r\nfunction confirmAllSupply(){\r\n    $.ajax({\r\n        url: EBSMSLocal + '/api/MedicalConfirm/ConfirmAll',\r\n        method: 'post',\r\n    })\r\n    window.location.href = 'viewSchedule.html';\r\n}\r\n//Get all medical supply request\r\nfunction getMedicalRequest() {\r\n    $.ajax({\r\n        url: EBSMSLocal + '/api/MedicalConfirm/GetAllMedicalSupplyRequest',\r\n        method: 'get',\r\n        success: function (data) {\r\n            var table = document.getElementById('request').getElementsByTagName('tbody')[0];\r\n            for (var i = 0; i < data.length; i++) {\r\n                var newRow = table.insertRow(table.rows.length);\r\n                var newColumn;\r\n                newColumn = newRow.insertCell(0);\r\n                newColumn.appendChild(document.createTextNode(i + 1));\r\n\r\n                newColumn = newRow.insertCell(1);\r\n                var a = document.createElement('a');\r\n                a.appendChild(document.createTextNode(data[i]['id']));\r\n                a.href = 'requestDetail.html?code=' + data[i]['id']\r\n                    + '&sname=' + data[i]['surgeryName'] + '&pname=' + data[i]['patientName'];\r\n                newColumn.appendChild(a);\r\n\r\n                newColumn = newRow.insertCell(2);\r\n                newColumn.appendChild(document.createTextNode(data[i]['surgeryCatalogId']));\r\n                newColumn = newRow.insertCell(3);\r\n                newColumn.appendChild(document.createTextNode(data[i]['surgeryName']));\r\n                newColumn = newRow.insertCell(4);\r\n                newColumn.appendChild(document.createTextNode(data[i]['patientName']));\r\n                newColumn = newRow.insertCell(5);\r\n                newColumn.appendChild(document.createTextNode(data[i]['createdDate']));\r\n            }\r\n        }\r\n    })\r\n}"]}
=======

>>>>>>> e3f8073b0821727702a0e16cfbdf0e019f6920ce
