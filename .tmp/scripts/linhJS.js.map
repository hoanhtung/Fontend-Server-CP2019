{"version":3,"sources":["linhJS.js"],"names":["EBSMSLocal","getJSONfromSession","infoJSON","JSON","parse","sessionStorage","getItem","supplyJSON","parseImportInfo","ExcelExport","event","input","target","reader","FileReader","onload","fileData","result","wb","XLSX","read","type","SheetNames","forEach","sheetName","rowObj","utils","sheet_to_row_object_array","Sheets","setItem","stringify","readAsBinaryString","files","jsonObj","table","document","getElementById","getElementsByTagName","i","length","newRow","insertRow","rows","newColumn","insertCell","a","createElement","appendChild","createTextNode","href","saveSurgeryProfile","shift","shiftInfo","sh","gender","proStartDate","proEndDate","day","start","split","end","push","Number","$","ajax","url","method","data","contentType","dataType","success","supplyList","supplyJson","s","medicalSupplyId","surgeryShiftCode","console","log","removeItem","deleteRecord","url_string","window","location","URL","no","searchParams","get","javascript","parseJSONImportDetail","j","getImportDetail","surgeryCode","getRequestDetail","innerHTML","surgeryShiftId","confirmSupply","confirmAllSupply","getMedicalRequest"],"mappings":"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","file":"linhJS.js","sourcesContent":["var EBSMSLocal = 'https://localhost:44372';\r\n\r\nfunction getJSONfromSession() {\r\n    var infoJSON = JSON.parse(sessionStorage.getItem(\"infoObj\"));\r\n    var supplyJSON = JSON.parse(sessionStorage.getItem(\"supplyObj\"));\r\n    if (infoJSON != null)\r\n        parseImportInfo(infoJSON);\r\n}\r\n\r\nfunction ExcelExport(event) {\r\n    var input = event.target;\r\n    var reader = new FileReader();\r\n    reader.onload = function () {\r\n        var fileData = reader.result;\r\n        var wb = XLSX.read(fileData, { type: 'binary' });\r\n\r\n        wb.SheetNames.forEach(function (sheetName) {\r\n            var rowObj = XLSX.utils.sheet_to_row_object_array(wb.Sheets[sheetName]);\r\n\r\n            switch (sheetName) {\r\n                case \"SurgeryProfile\":\r\n                    parseImportInfo(rowObj);\r\n                    sessionStorage.setItem('infoObj', JSON.stringify(rowObj));\r\n                    break;\r\n                case \"MedicalSupply\":\r\n                    sessionStorage.setItem('supplyObj', JSON.stringify(rowObj));\r\n                    break;\r\n            }\r\n        })\r\n    };\r\n    reader.readAsBinaryString(input.files[0]);\r\n};\r\nfunction parseImportInfo(jsonObj) {\r\n    var table = document.getElementById('profile').getElementsByTagName('tbody')[0];\r\n    for (var i = 0; i < jsonObj.length; i++) {\r\n        var newRow = table.insertRow(table.rows.length);\r\n        var newColumn;\r\n\r\n        newColumn = newRow.insertCell(0);\r\n        var a = document.createElement('a');\r\n        a.appendChild(document.createTextNode(jsonObj[i][\"Patient Name\"]));\r\n        a.href = \"importDetail.html?no=\" + jsonObj[i][\"Surgery Shift Code\"];\r\n        newColumn.appendChild(a);\r\n\r\n        newColumn = newRow.insertCell(1);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i][\"Gender\"]));\r\n        newColumn = newRow.insertCell(2);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i][\"Medical Record\"]));\r\n        newColumn = newRow.insertCell(3);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i][\"Surgery Name\"]));\r\n        newColumn = newRow.insertCell(4);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i][\"Surgeon Name\"]));\r\n        newColumn = newRow.insertCell(5);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i][\"Expected Date\"] +\r\n            \" - \" + jsonObj[i][\"Expected Time\"]));\r\n        newColumn = newRow.insertCell(6);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i][\"Surgery Weight\"]));\r\n    }\r\n}\r\n\r\nfunction saveSurgeryProfile() {\r\n    var shift = JSON.parse(sessionStorage.getItem(\"infoObj\"));\r\n    var shiftInfo = [];\r\n    for (var sh in shift) {\r\n        var gender = -1;\r\n        var proStartDate = \"\", proEndDate = \"\";\r\n        if (shift[sh][\"Expected Date\"] != \"NULL\") {\r\n            var day = shift[sh][\"Expected Date\"];\r\n            var start = shift[sh][\"Expected Time\"].split(' - ')[0];\r\n            var end = shift[sh][\"Expected Time\"].split(' - ')[1];\r\n            proStartDate = day + \" \" + start;\r\n            proEndDate = day + \" \" + end;\r\n        }\r\n        if (shift[sh][\"Gender\"] == \"Male\") gender = 1;\r\n        shiftInfo.push({\r\n            \"expectedSurgeryDuration\": shift[sh][\"Surgery Weight\"],\r\n            \"priorityNumber\": Number(shift[sh][\"Priority\"]),\r\n            \"patientID\": shift[sh][\"Patient Id\"],\r\n            \"patientName\": shift[sh][\"Patient Name\"],\r\n            \"gender\": gender,\r\n            \"yearOfBirth\": Number(shift[sh][\"Patient DOB\"]),\r\n            \"surgeryCatalogID\": Number(shift[sh][\"Surgery Code\"]),\r\n            \"surgeryShiftCode\": shift[sh][\"Surgery Shift Code\"],\r\n            \"surgoenId\": Number(shift[sh][\"SurgeonID\"]),\r\n            \"proposedStartDateTime\": proStartDate,\r\n            \"proposedEndDateTime\": proEndDate\r\n        })\r\n    }\r\n\r\n    $.ajax({\r\n        url: EBSMSLocal + \"/api/Import/ImportSurgeryShift\",\r\n        method: \"post\",\r\n        data: JSON.stringify(shiftInfo),\r\n        contentType: \"application/json\",\r\n        dataType: \"json\",\r\n        success: function () {\r\n            var supplyList = JSON.parse(sessionStorage.getItem(\"supplyObj\"));\r\n            var supplyJson = [];\r\n            for (var s in supplyList) {\r\n                supplyJson.push({\r\n                    medicalSupplyId: Number(supplyList[s][\"Code\"]),\r\n                    surgeryShiftCode: supplyList[s][\"Surgery Shift Code\"]\r\n                });\r\n            }\r\n            console.log(supplyJson);\r\n            $.ajax({\r\n                url: EBSMSLocal + \"/api/Import/ImportSurgeryShiftMedicalSupply\",\r\n                method: \"post\",\r\n                data: JSON.stringify(supplyJson),\r\n                contentType: \"application/json\",\r\n                dataType: \"json\"\r\n            })\r\n            sessionStorage.removeItem(\"infoObj\");\r\n            sessionStorage.removeItem(\"supplyObj\");\r\n        }\r\n    })\r\n\r\n}\r\n\r\nfunction deleteRecord() {\r\n    var supplyJSON = JSON.parse(sessionStorage.getItem(\"supplyObj\"));\r\n    var infoJSON = JSON.parse(sessionStorage.getItem(\"infoObj\"));\r\n    var url_string = window.location.href;\r\n    var url = new URL(url_string);\r\n    var no = url.searchParams.get(\"no\");\r\n\r\n    for (var i = 0; i < infoJSON.length; i++) {\r\n        if (infoJSON[i][\"Surgery Shift Code\"] == no) {\r\n            delete infoJSON[i];\r\n            break;\r\n        }\r\n    }\r\n    for (var i = 0; i < supplyJSON.length; i++) {\r\n        if (supplyJSON[i][\"Surgery Shift Code\"] == no) {\r\n            delete supplyJSON[i];\r\n            i--;\r\n        }\r\n    }\r\n    sessionStorage.removeItem(\"infoJSON\");\r\n    sessionStorage.removeItem(\"supplyJSON\");\r\n    sessionStorage.setItem('infoObj', JSON.stringify(infoJSON));\r\n    sessionStorage.setItem('supplyJSON', JSON.stringify(supplyJSON));\r\n    javascript: window.location.href = 'importList.html';\r\n}\r\n\r\nfunction parseJSONImportDetail(jsonObj) {\r\n    var table = document.getElementById('listSupply').getElementsByTagName('tbody')[0];\r\n    var supplyJSON = jsonObj;\r\n    var j = 0;\r\n    var url_string = window.location.href;\r\n    var url = new URL(url_string);\r\n    var no = url.searchParams.get(\"no\");\r\n    for (var i = 0; i < supplyJSON.length; i++) {\r\n        if (supplyJSON[i][\"Surgery Shift Code\"] == no) {\r\n            var newRow = table.insertRow(table.rows.length);\r\n            var newColumn;\r\n\r\n            newColumn = newRow.insertCell(0);\r\n            newColumn.appendChild(document.createTextNode(++j));\r\n            newColumn = newRow.insertCell(1);\r\n            newColumn.appendChild(document.createTextNode(supplyJSON[i][\"Code\"]));\r\n            newColumn = newRow.insertCell(2);\r\n            newColumn.appendChild(document.createTextNode(supplyJSON[i][\"Name\"]));\r\n        }\r\n    }\r\n}\r\n\r\nfunction getImportDetail() {\r\n    //get surgery code from url\r\n    var url_string = window.location.href;\r\n    var url = new URL(url_string);\r\n    var no = url.searchParams.get(\"no\");\r\n\r\n    var supplyJSON = JSON.parse(sessionStorage.getItem(\"supplyObj\"));\r\n    parseJSONImportDetail(supplyJSON);\r\n}\r\n\r\n// === JS for MEDICAL SUPPLY CONFIRM ===\r\nvar surgeryCode;\r\n\r\nfunction getRequestDetail() {\r\n    //get surgery code from url\r\n    var url_string = window.location.href;\r\n    var url = new URL(url_string);\r\n    surgeryCode = url.searchParams.get(\"code\");\r\n    document.getElementById(\"sid\").innerHTML = surgeryCode;\r\n    document.getElementById(\"name\").innerHTML = url.searchParams.get(\"sname\");\r\n    document.getElementById(\"patient\").innerHTML = url.searchParams.get(\"pname\");\r\n    $.ajax({\r\n        url: EBSMSLocal + \"/api/MedicalConfirm/GetMedicalSupplyRequest\",\r\n        method: \"get\",\r\n        data: { surgeryShiftId: surgeryCode },\r\n        success: function (data) {\r\n            var table = document.getElementById('listSupply').getElementsByTagName('tbody')[0];\r\n            for (var i = 0; i < data.length; i++) {\r\n                var newRow = table.insertRow(table.rows.length);\r\n                var newColumn;\r\n\r\n                newColumn = newRow.insertCell(0);\r\n                newColumn.appendChild(document.createTextNode(i + 1));\r\n                newColumn = newRow.insertCell(1);\r\n                newColumn.appendChild(document.createTextNode(data[i][\"code\"]));\r\n                newColumn = newRow.insertCell(2);\r\n                newColumn.appendChild(document.createTextNode(data[i][\"name\"]));\r\n            }\r\n        }\r\n    })\r\n}\r\n//Send confirm MS\r\nfunction confirmSupply() {\r\n    $.ajax({\r\n        url: EBSMSLocal + \"/api/MedicalConfirm/ConfirmMedicalRequest\",\r\n        method: \"get\",\r\n        data: { surgeryShiftId: surgeryCode }\r\n    })\r\n    window.location.href = 'confirmMSRequest.html';\r\n}\r\n\r\nfunction confirmAllSupply(){\r\n    $.ajax({\r\n        url: EBSMSLocal + \"/api/MedicalConfirm/ConfirmedAllSupplyRequest\",\r\n        method: \"get\",\r\n    })\r\n    window.location.href = 'confirmMSRequest.html';\r\n}\r\n//Get all medical supply request\r\nfunction getMedicalRequest() {\r\n    $.ajax({\r\n        url: EBSMSLocal + \"/api/MedicalConfirm/GetAllMedicalSupplyRequest\",\r\n        method: \"get\",\r\n        success: function (data) {\r\n            var table = document.getElementById('request').getElementsByTagName('tbody')[0];\r\n            for (var i = 0; i < data.length; i++) {\r\n                var newRow = table.insertRow(table.rows.length);\r\n                var newColumn;\r\n                newColumn = newRow.insertCell(0);\r\n                newColumn.appendChild(document.createTextNode(i + 1));\r\n\r\n                newColumn = newRow.insertCell(1);\r\n                var a = document.createElement('a');\r\n                a.appendChild(document.createTextNode(data[i][\"id\"]));\r\n                a.href = \"requestDetail.html?code=\" + data[i][\"id\"]\r\n                    + \"&sname=\" + data[i][\"surgeryName\"] + \"&pname=\" + data[i][\"patientName\"];\r\n                newColumn.appendChild(a);\r\n\r\n                newColumn = newRow.insertCell(2);\r\n                newColumn.appendChild(document.createTextNode(data[i][\"surgeryCatalogId\"]));\r\n                newColumn = newRow.insertCell(3);\r\n                newColumn.appendChild(document.createTextNode(data[i][\"surgeryName\"]));\r\n                newColumn = newRow.insertCell(4);\r\n                newColumn.appendChild(document.createTextNode(data[i][\"patientName\"]));\r\n                newColumn = newRow.insertCell(5);\r\n                newColumn.appendChild(document.createTextNode(data[i][\"createdDate\"]));\r\n            }\r\n        }\r\n    })\r\n}"]}