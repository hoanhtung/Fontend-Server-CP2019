{"version":3,"sources":["linhJS.js"],"names":["EBSMSLocal","removeSessionStorage","sessionStorage","removeItem","javascript","window","location","href","getJSONfromSession","infoJSON","JSON","parse","getItem","supplyJSON","parseImportInfo","ExcelExport","event","input","target","reader","FileReader","onload","fileData","result","wb","XLSX","read","type","SheetNames","forEach","sheetName","rowObj","utils","sheet_to_row_object_array","Sheets","setItem","stringify","readAsBinaryString","files","jsonObj","table","document","getElementById","getElementsByTagName","i","length","newRow","insertRow","rows","newColumn","insertCell","a","createElement","appendChild","createTextNode","saveSurgeryProfile","shift","shiftInfo","sh","gender","proStartDate","proEndDate","day","start","split","end","push","Number","$","ajax","url","method","data","contentType","dataType","success","supplyList","supplyJson","s","medicalSupplyId","surgeryShiftCode","console","log","alert","deleteRecord","url_string","URL","no","searchParams","get","parseJSONImportDetail","j","getImportDetail","surgeryCode","getRequestDetail","innerHTML","surgeryShiftId","confirmSupply","confirmAllSupply","getMedicalRequest"],"mappings":"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","file":"linhJS.js","sourcesContent":["var EBSMSLocal = 'https://localhost:44372';\r\n\r\nfunction removeSessionStorage() {\r\n    sessionStorage.removeItem('infoObj');\r\n    sessionStorage.removeItem('supplyObj');\r\n    javascript:window.location.href='importList.html'\r\n}\r\n\r\nfunction getJSONfromSession() {\r\n    var infoJSON = JSON.parse(sessionStorage.getItem('infoObj'));\r\n    var supplyJSON = JSON.parse(sessionStorage.getItem('supplyObj'));\r\n    if (infoJSON != null)\r\n        parseImportInfo(infoJSON);\r\n}\r\n\r\nfunction ExcelExport(event) {\r\n    var input = event.target;\r\n    var reader = new FileReader();\r\n    reader.onload = function () {\r\n        var fileData = reader.result;\r\n        var wb = XLSX.read(fileData, { type: 'binary' });\r\n\r\n        wb.SheetNames.forEach(function (sheetName) {\r\n            var rowObj = XLSX.utils.sheet_to_row_object_array(wb.Sheets[sheetName]);\r\n\r\n            switch (sheetName) {\r\n                case 'SurgeryProfile':\r\n                    parseImportInfo(rowObj);\r\n                    sessionStorage.setItem('infoObj', JSON.stringify(rowObj));\r\n                    break;\r\n                case 'MedicalSupply':\r\n                    sessionStorage.setItem('supplyObj', JSON.stringify(rowObj));\r\n                    break;\r\n            }\r\n        })\r\n    };\r\n    reader.readAsBinaryString(input.files[0]);\r\n};\r\nfunction parseImportInfo(jsonObj) {\r\n    var table = document.getElementById('profile').getElementsByTagName('tbody')[0];\r\n    for (var i = 0; i < jsonObj.length; i++) {\r\n        var newRow = table.insertRow(table.rows.length);\r\n        var newColumn;\r\n\r\n        newColumn = newRow.insertCell(0);\r\n        var a = document.createElement('a');\r\n        a.appendChild(document.createTextNode(jsonObj[i]['Patient Name']));\r\n        a.href = 'importDetail.html?no=' + jsonObj[i]['Surgery Shift Code'];\r\n        newColumn.appendChild(a);\r\n\r\n        newColumn = newRow.insertCell(1);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i]['Gender']));\r\n        newColumn = newRow.insertCell(2);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i]['Medical Record']));\r\n        newColumn = newRow.insertCell(3);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i]['Surgery Name']));\r\n        newColumn = newRow.insertCell(4);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i]['Surgeon Name']));\r\n        newColumn = newRow.insertCell(5);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i]['Expected Date'] +\r\n            ' - ' + jsonObj[i]['Expected Time']));\r\n        newColumn = newRow.insertCell(6);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i]['Surgery Weight']));\r\n    }\r\n}\r\n\r\nfunction saveSurgeryProfile() {\r\n    var shift = JSON.parse(sessionStorage.getItem('infoObj'));\r\n    var shiftInfo = [];\r\n    for (var sh in shift) {\r\n        var gender = -1;\r\n        var proStartDate = '', proEndDate = '';\r\n        if (shift[sh]['Expected Date'] != 'NULL') {\r\n            var day = shift[sh]['Expected Date'];\r\n            var start = shift[sh]['Expected Time'].split(' - ')[0];\r\n            var end = shift[sh]['Expected Time'].split(' - ')[1];\r\n            proStartDate = day + ' ' + start;\r\n            proEndDate = day + ' ' + end;\r\n        }\r\n        if (shift[sh]['Gender'] == 'Male') gender = 1;\r\n        shiftInfo.push({\r\n            'expectedSurgeryDuration': shift[sh]['Surgery Weight'],\r\n            'priorityNumber': Number(shift[sh]['Priority']),\r\n            'patientID': shift[sh]['Patient Id'],\r\n            'patientName': shift[sh]['Patient Name'],\r\n            'gender': gender,\r\n            'yearOfBirth': Number(shift[sh]['Patient DOB']),\r\n            'surgeryCatalogID': Number(shift[sh]['Surgery Code']),\r\n            'surgeryShiftCode': shift[sh]['Surgery Shift Code'],\r\n            'surgoenId': Number(shift[sh]['SurgeonID']),\r\n            'proposedStartDateTime': proStartDate,\r\n            'proposedEndDateTime': proEndDate\r\n        })\r\n    }\r\n\r\n    $.ajax({\r\n        url: EBSMSLocal + '/api/Import/ImportSurgeryShift',\r\n        method: 'post',\r\n        data: JSON.stringify(shiftInfo),\r\n        contentType: 'application/json',\r\n        dataType: 'json',\r\n        success: function () {\r\n            var supplyList = JSON.parse(sessionStorage.getItem('supplyObj'));\r\n            var supplyJson = [];\r\n            for (var s in supplyList) {\r\n                supplyJson.push({\r\n                    medicalSupplyId: Number(supplyList[s]['Code']),\r\n                    surgeryShiftCode: supplyList[s]['Surgery Shift Code']\r\n                });\r\n            }\r\n            console.log(supplyJson);\r\n            $.ajax({\r\n                url: EBSMSLocal + '/api/Import/ImportSurgeryShiftMedicalSupply',\r\n                method: 'post',\r\n                data: JSON.stringify(supplyJson),\r\n                contentType: 'application/json',\r\n                dataType: 'json',\r\n                success: function() {\r\n                    sessionStorage.removeItem('infoObj');\r\n                    sessionStorage.removeItem('supplyObj');\r\n                    alert('Import successfully!')\r\n                    window.location.href = 'importList.html';\r\n                }\r\n            })\r\n            \r\n        }\r\n    })\r\n\r\n}\r\n\r\nfunction deleteRecord() {\r\n    var supplyJSON = JSON.parse(sessionStorage.getItem('supplyObj'));\r\n    var infoJSON = JSON.parse(sessionStorage.getItem('infoObj'));\r\n    var url_string = window.location.href;\r\n    var url = new URL(url_string);\r\n    var no = url.searchParams.get('no');\r\n\r\n    for (var i = 0; i < infoJSON.length; i++) {\r\n        if (infoJSON[i]['Surgery Shift Code'] == no) {\r\n            delete infoJSON[i];\r\n            break;\r\n        }\r\n    }\r\n    for (var i = 0; i < supplyJSON.length; i++) {\r\n        if (supplyJSON[i]['Surgery Shift Code'] == no) {\r\n            delete supplyJSON[i];\r\n            i--;\r\n        }\r\n    }\r\n    sessionStorage.removeItem('infoJSON');\r\n    sessionStorage.removeItem('supplyJSON');\r\n    sessionStorage.setItem('infoObj', JSON.stringify(infoJSON));\r\n    sessionStorage.setItem('supplyJSON', JSON.stringify(supplyJSON));\r\n    javascript: window.location.href = 'importList.html';\r\n}\r\n\r\nfunction parseJSONImportDetail(jsonObj) {\r\n    var table = document.getElementById('listSupply').getElementsByTagName('tbody')[0];\r\n    var supplyJSON = jsonObj;\r\n    var j = 0;\r\n    var url_string = window.location.href;\r\n    var url = new URL(url_string);\r\n    var no = url.searchParams.get('no');\r\n    for (var i = 0; i < supplyJSON.length; i++) {\r\n        if (supplyJSON[i]['Surgery Shift Code'] == no) {\r\n            var newRow = table.insertRow(table.rows.length);\r\n            var newColumn;\r\n\r\n            newColumn = newRow.insertCell(0);\r\n            newColumn.appendChild(document.createTextNode(++j));\r\n            newColumn = newRow.insertCell(1);\r\n            newColumn.appendChild(document.createTextNode(supplyJSON[i]['Code']));\r\n            newColumn = newRow.insertCell(2);\r\n            newColumn.appendChild(document.createTextNode(supplyJSON[i]['Name']));\r\n        }\r\n    }\r\n}\r\n\r\nfunction getImportDetail() {\r\n    //get surgery code from url\r\n    var url_string = window.location.href;\r\n    var url = new URL(url_string);\r\n    var no = url.searchParams.get('no');\r\n\r\n    var supplyJSON = JSON.parse(sessionStorage.getItem('supplyObj'));\r\n    parseJSONImportDetail(supplyJSON);\r\n}\r\n\r\n// === JS for MEDICAL SUPPLY CONFIRM ===\r\nvar surgeryCode;\r\n\r\nfunction getRequestDetail() {\r\n    //get surgery code from url\r\n    var url_string = window.location.href;\r\n    var url = new URL(url_string);\r\n    surgeryCode = url.searchParams.get('code');\r\n    document.getElementById('sid').innerHTML = surgeryCode;\r\n    document.getElementById('name').innerHTML = url.searchParams.get('sname');\r\n    document.getElementById('patient').innerHTML = url.searchParams.get('pname');\r\n    $.ajax({\r\n        url: EBSMSLocal + '/api/MedicalConfirm/GetMedicalSupplyRequest',\r\n        method: 'get',\r\n        data: { surgeryShiftId: surgeryCode },\r\n        success: function (data) {\r\n            var table = document.getElementById('listSupply').getElementsByTagName('tbody')[0];\r\n            for (var i = 0; i < data.length; i++) {\r\n                var newRow = table.insertRow(table.rows.length);\r\n                var newColumn;\r\n\r\n                newColumn = newRow.insertCell(0);\r\n                newColumn.appendChild(document.createTextNode(i + 1));\r\n                newColumn = newRow.insertCell(1);\r\n                newColumn.appendChild(document.createTextNode(data[i]['code']));\r\n                newColumn = newRow.insertCell(2);\r\n                newColumn.appendChild(document.createTextNode(data[i]['name']));\r\n            }\r\n        }\r\n    })\r\n}\r\n//Send confirm MS\r\nfunction confirmSupply() {\r\n    $.ajax({\r\n        url: EBSMSLocal + '/api/MedicalConfirm/ConfirmMedicalRequest',\r\n        method: 'get',\r\n        data: { surgeryShiftId: surgeryCode }\r\n    })\r\n    window.location.href = 'confirmMSRequest.html';\r\n}\r\n\r\nfunction confirmAllSupply(){\r\n    alert('asdasdas');\r\n    $.ajax({\r\n        url: EBSMSLocal + '/api/MedicalConfirm/ConfirmedAllSupplyRequest',\r\n        method: 'get',\r\n    })\r\n    window.location.href = 'confirmMSRequest.html';\r\n}\r\n//Get all medical supply request\r\nfunction getMedicalRequest() {\r\n    $.ajax({\r\n        url: EBSMSLocal + '/api/MedicalConfirm/GetAllMedicalSupplyRequest',\r\n        method: 'get',\r\n        success: function (data) {\r\n            var table = document.getElementById('request').getElementsByTagName('tbody')[0];\r\n            for (var i = 0; i < data.length; i++) {\r\n                var newRow = table.insertRow(table.rows.length);\r\n                var newColumn;\r\n                newColumn = newRow.insertCell(0);\r\n                newColumn.appendChild(document.createTextNode(i + 1));\r\n\r\n                newColumn = newRow.insertCell(1);\r\n                var a = document.createElement('a');\r\n                a.appendChild(document.createTextNode(data[i]['id']));\r\n                a.href = 'requestDetail.html?code=' + data[i]['id']\r\n                    + '&sname=' + data[i]['surgeryName'] + '&pname=' + data[i]['patientName'];\r\n                newColumn.appendChild(a);\r\n\r\n                newColumn = newRow.insertCell(2);\r\n                newColumn.appendChild(document.createTextNode(data[i]['surgeryCatalogId']));\r\n                newColumn = newRow.insertCell(3);\r\n                newColumn.appendChild(document.createTextNode(data[i]['surgeryName']));\r\n                newColumn = newRow.insertCell(4);\r\n                newColumn.appendChild(document.createTextNode(data[i]['patientName']));\r\n                newColumn = newRow.insertCell(5);\r\n                newColumn.appendChild(document.createTextNode(data[i]['createdDate']));\r\n            }\r\n        }\r\n    })\r\n}"]}