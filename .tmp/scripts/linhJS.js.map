{"version":3,"sources":["linhJS.js"],"names":["EBSMSLocal","infoJON","suppyJSON","getJSONfromSeesion","JSON","parse","sessionStorage","getItem","parseInfo","ExcelExport","event","input","target","reader","FileReader","onload","fileData","result","wb","XLSX","read","type","SheetNames","forEach","sheetName","rowObj","utils","sheet_to_row_object_array","Sheets","setItem","stringify","readAsBinaryString","files","jsonObj","console","log","table","document","getElementById","getElementsByTagName","i","length","newRow","insertRow","rows","newColumn","insertCell","a","createElement","appendChild","createTextNode","href","saveSurgeryProfile","alert","$","ajax","url","method","success","data","id","removeItem","no","supplyJSON","infoJSON","deleteRecord","javascript","window","location","parseJSON","j","getImportDetail","url_string","URL","searchParams","get","confirmSupply"],"mappings":"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","file":"linhJS.js","sourcesContent":["var EBSMSLocal = 'https://localhost:44372';\r\n\r\nvar infoJON, suppyJSON;\r\nfunction getJSONfromSeesion() {\r\n    infoJON = JSON.parse(sessionStorage.getItem(\"infoObj\"));\r\n    suppyJSON = JSON.parse(sessionStorage.getItem(\"supplyObj\"));\r\n    parseInfo(infoJON);\r\n}\r\nfunction ExcelExport(event) {\r\n    var input = event.target;\r\n    var reader = new FileReader();\r\n    reader.onload = function () {\r\n        var fileData = reader.result;\r\n        var wb = XLSX.read(fileData, { type: 'binary' });\r\n\r\n        wb.SheetNames.forEach(function (sheetName) {\r\n            var rowObj = XLSX.utils.sheet_to_row_object_array(wb.Sheets[sheetName]);\r\n\r\n            switch (sheetName) {\r\n                case \"SurgeryProfile\":\r\n                    parseInfo(rowObj);\r\n                    infoJON = rowObj;\r\n                    sessionStorage.setItem('infoObj', JSON.stringify(rowObj));\r\n                    break;\r\n                case \"MedicalSupply\":\r\n                    suppyJSON = rowObj;\r\n                    sessionStorage.setItem('supplyObj', JSON.stringify(rowObj));\r\n                    break;\r\n            }\r\n        })\r\n    };\r\n    reader.readAsBinaryString(input.files[0]);\r\n};\r\nfunction parseInfo(jsonObj) {\r\n    console.log(jsonObj);\r\n    var table = document.getElementById('profile').getElementsByTagName('tbody')[0];\r\n    for (var i = 0; i < jsonObj.length; i++) {\r\n        var newRow = table.insertRow(table.rows.length);\r\n        var newColumn;\r\n\r\n        newColumn = newRow.insertCell(0);\r\n        var a = document.createElement('a');\r\n        a.appendChild(document.createTextNode(jsonObj[i][\"Patient Name\"]));\r\n        a.href = \"importDetail.html?no=\" + jsonObj[i][\"Surgery Shift Code\"];\r\n        newColumn.appendChild(a);\r\n\r\n\r\n        newColumn = newRow.insertCell(1);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i][\"Gender\"]));\r\n        newColumn = newRow.insertCell(2);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i][\"Medical Record\"]));\r\n        newColumn = newRow.insertCell(3);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i][\"Surgery Name\"]));\r\n        newColumn = newRow.insertCell(4);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i][\"Surgeon Name\"]));\r\n        newColumn = newRow.insertCell(5);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i][\"Expected Date\"] +\r\n            \" - \" + jsonObj[i][\"Expected Time\"]));\r\n        newColumn = newRow.insertCell(6);\r\n        newColumn.appendChild(document.createTextNode(jsonObj[i][\"Surgery Weight\"]));\r\n    }\r\n}\r\n// done\r\n\r\n\r\nfunction saveSurgeryProfile() {\r\n    alert(\"Surgery Profile Saved\");\r\n            //TODO: call insert API\r\n    $.ajax({\r\n        url: EBSMSLocal + \"/api/PostOp/GetAllMedicalSupplyRequest\",\r\n        method: \"get\",\r\n        success: function(data) {\r\n            console.log(data[0].id);\r\n        }\r\n    })\r\n    sessionStorage.removeItem(\"infoObj\");\r\n    sessionStorage.removeItem(\"supplyObj\");\r\n    // window.location.replace(\"importList.html\");\r\n};\r\n\r\n\r\n\r\n\r\nvar no;\r\nvar supplyJSON;\r\nvar infoJSON;\r\nfunction deleteRecord() {\r\n    supplyJSON = JSON.parse(sessionStorage.getItem(\"supplyObj\"));\r\n    infoJSON = JSON.parse(sessionStorage.getItem(\"infoObj\"));\r\n    for (var i = 0; i < infoJSON.length; i++) {\r\n        if (infoJSON[i][\"Surgery Shift Code\"] == no) {\r\n            delete infoJSON[i];\r\n            break;\r\n        }\r\n    }\r\n    for (var i = 0; i < supplyJSON.length; i++) {\r\n        if (supplyJSON[i][\"Surgery Shift Code\"] == no) {\r\n            delete supplyJSON[i];\r\n            i--;\r\n        }\r\n    }\r\n    sessionStorage.removeItem(\"infoJSON\");\r\n    sessionStorage.removeItem(\"supplyJSON\");\r\n    sessionStorage.setItem('infoObj', JSON.stringify(infoJSON));\r\n    sessionStorage.setItem('supplyJSON', JSON.stringify(supplyJSON));\r\n    javascript: window.location.href = 'importList.html';\r\n}\r\n\r\nfunction parseJSON(jsonObj) {\r\n    var table = document.getElementById('listSupply').getElementsByTagName('tbody')[0];\r\n    var j = 0;\r\n    for (var i = 0; i < supplyJSON.length; i++) {\r\n        if (supplyJSON[i][\"Surgery Shift Code\"] == no) {\r\n            var newRow = table.insertRow(table.rows.length);\r\n            var newColumn;\r\n\r\n            newColumn = newRow.insertCell(0);\r\n            newColumn.appendChild(document.createTextNode(++j));\r\n            newColumn = newRow.insertCell(1);\r\n            newColumn.appendChild(document.createTextNode(supplyJSON[i][\"Code\"]));\r\n            newColumn = newRow.insertCell(2);\r\n            newColumn.appendChild(document.createTextNode(supplyJSON[i][\"Name\"]));\r\n            newColumn = newRow.insertCell(3);\r\n            newColumn.appendChild(document.createTextNode(supplyJSON[i][\"Quantity\"]));\r\n        }\r\n    }\r\n}\r\n\r\nfunction getImportDetail() {\r\n    //get surgery code from url\r\n    var url_string = window.location.href;\r\n    var url = new URL(url_string);\r\n    no = url.searchParams.get(\"no\");\r\n\r\n    supplyJSON = JSON.parse(sessionStorage.getItem(\"supplyObj\"));\r\n    parseJSON(supplyJSON);\r\n}\r\n\r\nfunction confirmSupply() {\r\n    //TODO: send api with surgery code = surgeryCode;\r\n\r\n    javascript: window.location.href = 'confirmMSRequest.html';\r\n}"]}